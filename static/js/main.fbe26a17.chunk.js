(this["webpackJsonpinstagram-task"]=this["webpackJsonpinstagram-task"]||[]).push([[0],{106:function(e,t,a){"use strict";a.r(t);var n=a(6),c=a.n(n),s=a(33),r=a.n(s),o=(a(78),a(0)),i=a.n(o),l=a(3),u=a(16),p=(a(80),a(81),a(134)),d=a(39),j=d.a.initializeApp({apiKey:"AIzaSyAaMtUip99FHrJf410RXolBCXYPZgquAZU",authDomain:"instagram-clone-10dc3.firebaseapp.com",projectId:"instagram-clone-10dc3",storageBucket:"instagram-clone-10dc3.appspot.com",messagingSenderId:"803802603024",appId:"1:803802603024:web:1011dc282a98eb1ab3b495",measurementId:"G-RWX5KG0BXS"}).firestore(),b=d.a.auth(),m=d.a.storage(),g=a(17);var f=function(e){var t=e.postId,a=(e.user,e.username),c=e.caption,s=e.imageUrl,r=Object(n.useState)([]),o=Object(u.a)(r,2),i=o[0],l=o[1],d=Object(n.useState)(""),b=Object(u.a)(d,2),m=b[0],f=b[1];return Object(n.useEffect)((function(){var e;return t&&(e=j.collection("posts").doc(t).collection("comments").onSnapShot((function(e){l(e.docs.map((function(e){return e.data()})))}))),function(){e()}}),[t]),Object(g.jsxs)("div",{className:"post",children:[Object(g.jsxs)("div",{className:"post__header",children:[Object(g.jsx)(p.a,{className:"post_avatar",alt:a,src:"/static/images/avatar1.jpg"}),Object(g.jsx)("h3",{children:a})]}),Object(g.jsx)("img",{className:"post__images",src:s,alt:""}),Object(g.jsxs)("h4",{className:"caption",children:[Object(g.jsxs)("strong",{children:[a," "]}),c]}),Object(g.jsx)("div",{className:"post__comments",children:i.map((function(e){return Object(g.jsxs)("p",{children:[Object(g.jsx)("strong",{children:e.username}),e.text]})}))}),Object(g.jsxs)("form",{className:"post__commentBox",children:[Object(g.jsx)("input",{className:"post__input",type:"text",placeholder:"Add a comment",value:m,onChange:function(e){return f(e.target.value)}}),Object(g.jsx)("button",{className:"post__button",disabled:!m,type:"submit",onClick:function(e){},children:"Post"})]})]})},h=a(132),O=(a(88),a(70)),x=a.n(O).a.create({baseURL:"http://localhost:8080"});var v=function(e){var t=e.username,a=Object(n.useState)(null),c=Object(u.a)(a,2),s=c[0],r=c[1],o=Object(n.useState)(0),i=Object(u.a)(o,2),l=i[0],p=i[1],b=Object(n.useState)(""),f=Object(u.a)(b,2),O=f[0],v=f[1];return Object(g.jsxs)("div",{className:"imageupload",children:[Object(g.jsx)("progress",{className:"imageupload__progress",value:l,max:"100"}),Object(g.jsx)("input",{type:"text",placeholder:"Enter a caption",onChange:function(e){return v(e.target.value)},value:O}),Object(g.jsx)("input",{type:"file",onChange:function(e){e.target.files[0]&&r(e.target.files[0])}}),Object(g.jsx)(h.a,{onClick:function(){m.ref("images/".concat(s.name)).put(s).on("state__changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);p(t)}),(function(e){console.log(e),alert(e.message)}),(function(){m.ref("images").child(s.name).getDownloadURL().then((function(e){x.post("/upload",{caption:O,user:t,image:e}),j.collection("posts").add({timestamp:d.a.firestore.FieldValue.serverTimestamp(),caption:O,imageUrl:e,username:t}),p(0),v(""),r(null)}))}))},children:"Upload"})]})},_=a(130),y=a(131),w=a(133),S=a(59),C=a.n(S);function N(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%,-").concat(50,"%)")}}var k=Object(_.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var I=function(){var e=k(),t=Object(n.useState)([]),a=Object(u.a)(t,2),c=a[0],s=a[1],r=Object(n.useState)(!1),o=Object(u.a)(r,2),p=o[0],d=o[1],j=Object(n.useState)(!1),m=Object(u.a)(j,2),O=m[0],_=m[1],S=Object(n.useState)(N),I=Object(u.a)(S,1)[0],U=Object(n.useState)(""),A=Object(u.a)(U,2),E=A[0],B=A[1],P=Object(n.useState)(!1),F=Object(u.a)(P,2),D=F[0],L=F[1],T=Object(n.useState)(null),R=Object(u.a)(T,2),X=R[0],J=R[1],M=Object(n.useState)(""),W=Object(u.a)(M,2),z=W[0],G=W[1];Object(n.useEffect)((function(){var e=b.onAuthStateChanged((function(e){e?(console.log(e),J(e)):J(null)}));return function(){e()}}),[X,E]);var K=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/sync").then((function(e){console.log(e),s(e.data)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){C.a.logToConsole=!0,new C.a("8220ee217a610440154a",{cluster:"eu"}).subscribe("posts").bind("inserted",(function(e){console.log("data recieved",e),K()}))}),[]),Object(n.useEffect)((function(){K()}),[]),Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(y.a,{open:O,onClose:function(){return _(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(g.jsx)("div",{style:I,className:e.paper,children:Object(g.jsxs)("center",{children:[Object(g.jsx)("img",{className:"app__headerImage",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",alt:""}),Object(g.jsxs)("form",{className:"app__signup",children:[Object(g.jsx)(w.a,{placeholder:"name",type:"text",value:E,onChange:function(e){return B(e.target.value)}}),Object(g.jsx)(w.a,{placeholder:"email",type:"text",value:z,onChange:function(e){return G(e.target.value)}}),Object(g.jsx)(w.a,{placeholder:"password",type:"password",value:D,onChange:function(e){return L(e.target.value)}}),Object(g.jsx)(h.a,{type:"submit",onClick:function(e){e.preventDefault(),b.createUserWithEmailAndPassword(z,D).then((function(e){return e.user.updateProfile({displayName:E})})).catch((function(e){return alert(e.message)}))},children:"Sign Up"})]})]})})}),Object(g.jsx)(y.a,{open:p,onClose:function(){return d(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(g.jsx)("div",{style:I,className:e.paper,children:Object(g.jsxs)("center",{children:[Object(g.jsx)("img",{className:"app__headerImage",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",alt:""}),Object(g.jsxs)("form",{className:"app__signup",children:[Object(g.jsx)(w.a,{placeholder:"email",type:"text",value:z,onChange:function(e){return G(e.target.value)}}),Object(g.jsx)(w.a,{placeholder:"password",type:"password",value:D,onChange:function(e){return L(e.target.value)}}),Object(g.jsx)(h.a,{type:"submit",onClick:function(e){e.preventDefault(),b.signInWithEmailAndPassword(z,D).catch((function(e){return alert(e.message)})),d(!1)},children:"Sign In"})]})]})})}),Object(g.jsxs)("div",{className:"app__header",children:[Object(g.jsx)("img",{className:"app__headerImage",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",alt:""}),X?Object(g.jsx)(h.a,{onClick:function(){return b.signOut()},children:"Logout"}):Object(g.jsxs)("div",{className:"app__loginContainer",children:[Object(g.jsx)(h.a,{onClick:function(){return d(!0)},children:"Sign In"}),Object(g.jsx)(h.a,{onClick:function(){return _(!0)},children:"Sign Up "})]})]}),Object(g.jsx)("div",{className:"app_post",children:c.map((function(e){return Object(g.jsx)(f,{posts:e._id,user:X,username:e.user,caption:e.caption,imageUrl:e.image},e._id)}))}),(null===X||void 0===X?void 0:X.displayName)?Object(g.jsx)(v,{username:X.displayName}):Object(g.jsx)("h3",{children:"Sorry you need to login to upload"})]})},U=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,136)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))};r.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(I,{})}),document.getElementById("root")),U()},78:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},88:function(e,t,a){}},[[106,1,2]]]);
//# sourceMappingURL=main.fbe26a17.chunk.js.map